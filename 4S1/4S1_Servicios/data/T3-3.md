
---
# Transferencia de archivos

[Back to index](../README.md)

---
## Introducción
- **Funcionalidades**
	- Examinar archivos de carpeta remota
	- Borrar y renombrar dichos archivos
	- Transferir archivos (*up* y *down*)
- **Interfaces**
	- Con cliente específico (consola o GUI)
		- **File Transfer Protocol (FTP)**. Antiguo. Casi en desuso
		- **Secure Copy (SCP)**. Copia archivos sobre SSH-1.
		- **Secure FTP (SFTP)**. Copia de archivos y más opciones sobre SSH-2
		- **FTP sobre SSL (FTPS)**. FTP sobre SSL/TLS
	- Integrados en sistema de archivos de cliente
		- **Network File System (NFS)**. Primer sistema de archivos remoto.
		- **Server Message Block (SMB)**. "Carpetas compartidas" en Windows (Microsoft)
		- **samba**. Implementación libre de SMB
		- **SSH File System (SSH-FS)**. NFS sobre ssh
	- Herramientas de colaboración (SVN / Git / WebDAV)
---
## File Transfer Protocolo
### Introducción
- Funciona sobre TCP
- Permite autenticación de usuario o "modo anónimo" (sin autenticación)
- No está cifrado. Es inseguro.
### Canales de Comunicación
- **Canal de Control** (puerto 21)
	- Transporta comandos del cliente y respuestas del servidor.
	- Permanece activo durante la sesión.
	- Similar a telnet. Comandos en cadenas ASCII terminadas por `\r\n`
	- Algunas acciones requieren multiples comandos.
	- Respuestas con código + mensaje. Pueden requerir apertura de canal de datos.
- **Canal de Datos** (puerto 22)
	- Se establece y cierra para cada transferencia.
	- Pueden ser ASCII (carácter especial `\n`) o binaria.
### Arquitectura
- **Componentes**
	- Cliente
		- Interfaz de usuario
		- Intérprete de protocolo (cliente)
		- Proceso de Transferencia de Datos (DTP)
	- Servidor
		- Intérprete de protocolo (servidor)
		- Proceso de Transferencia de Datos (DTP)
- **Funcionamiento**
	- El interprete de protocolo del servidor siempre se conectan con el del cliente.
	- Los DTP conectan los sistemas de archivos y se comunican con otros DTP.
	- UN DTP de servidor pueden conectarse con otro igual siempre orquestados por un cliente.
### Modos
- **Modo Activo** (*default*)
	1. El cliente inicia la conexión de control al servidor.
	2. El cliente crea un socket de escucha para los datos y envía el número de puerto.
	3. En cada transferencia (solicitada en control) es el servidor el que inicia el canal de datos.
	4. Bloqueada por Firewalls y no funciona con NAT ya que es una conexión TCP entrante.
- **Modo Pasivo**
	1.  El cliente inicia la conexión de control al servidor y solicita el modo pasivo.
	2. El servidor crea un socket de escucha para los datos y envía el número de puerto.
	3. En cada transferencia es el cliente el que inicia el canal de datos.
	4. Puesto que es una conexión TCP saliente, funciona con NAT y Firewalls.
### Comandos

| Mensaje                                                           | Descripción                                               |
| ----------------------------------------------------------------- | --------------------------------------------------------- |
| USER                                                              | Envía el nombre de usuario, para autenticación            |
| PASS                                                              | Envía la contraseña del usuario, para autenticación       |
| PORT                                                              | Envía el puerto de escucha del cliente (modo activo)      |
| PASV Solicita modo pasivo                                         | LIST Obtener listado del directorio actual                |
|                                                                   |                                                           |
| CWD                                                               | Cambio de directorio actual                               |
| CDUP                                                              | Subir un directorio                                       |
| TYPE                                                              | Establece el modo de la conexión de datos (ascii/binaria) |
| RETR Solicita descarga de archivo STOR Solicita subida de archivo |                                                           |

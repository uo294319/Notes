
---
# Cifrado Simétrico

[Back to index](../README.md)

---

## Introducción a Sistemas Criptográficos
- **Tipos**
	- Simétricos o de clave privada
		- Misma clave para cifrado y descifrado. Esta debe ser siempre privada.
	- Asimétricos o de clave pública
		- Distintas claves para cifrado y descifrado. Una es pública y otra privada.
- **Situación actual**
	- El cifrado debe depender de la clave, no del algoritmo.
	- Algoritmos públicos para que puedan ser auditados.
- Operaciones para encriptar
	- Transposiciones. Cambio de orden de símbolos.
	- Sustituciones. Reemplazo de símbolos por otros.
---
## Algoritmos Simétricos de Flujo
**Def**. Se combina texto plano con secuencia pseudoaleatoria `keystream`.  (Ej. `XOR`)
### Síncronos
 - **Def**. Secuencia de cifrado generada independientemente.
- Transmisor y receptor deben estar sincronizados.
	- Si se corrompen dígitos solo se afecta a esos.
	- Si se añaden se rompe sincronización.
### Auto-sincronizables
- **Def**. Secuencia de cifrado generada con los N dígitos previos del texto cifrado
- Sincronización automática tras recibir N dígitos del texto cifrado.
---
## Algoritmos Simétricos de Bloque
**Def**. Se trabaja con grupos de bits de longitud fija.
### ECB - *Electronic CodeBook*
- **Def**. Cada bloque de cifrado usa solo la clave y el texto plano para cifrar.
- Cada bloque es independiente y paralelizable.
![](../assets/Pasted%20image%2020251021100756.png)
### CBC - *Cipher Block Chaining*
- **Def**. Se hace una operación XOR con la entrada de cada bloque y salida del bloque anterior.
- La encriptación no es paralelizable pero la desencriptación sí.
- Es necesario un vector de inicialización (IV) para el primer bloque.
![](../assets/Pasted%20image%2020251021101106.png)
### CFB - *Cipher FeedBack*
- **Def**.
	- El bloque de cifrado recibe la llave y la salida del bloque anterior.
	- Luego hace XOR con el texto plano para producir el texto cifrado.
- La encriptación no es paralelizable pero la desencriptación sí.
- Es necesario un vector de inicialización (IV) para el primer bloque.
![](../assets/Pasted%20image%2020251021101951.png)
### OFB - *Output FeedBack*
- **Def**. Similar a CFB. Se usa la salida del bloque cifrador antes del XOR
- No paralelizable en 1 fase. Pero, si dividimos en dos fases...
	- Primero salidas de bloques de cifrado (no paralelizable)
	- Luego desencriptamos el texto cifrado en paralelo.
![](../assets/Pasted%20image%2020251021102559.png)

---
## AES
### Pasos
1. **Entrada**.
	1. Texto plano + clave de 128 (k=10), 192 (k=12) o 256 (k=14) bits
	2. Bloque forma de matrices (mismo tamaño clave). Se usan caracteres de relleno.
2. **Ronda Inicial**. (1 vez)
	1. Add_Round_Key (Clave Inicial - K0)
3. **Ronda Estándar** (k veces)
	1. Byte_Sub
	2. Shift_Row
	3. Mix_Columns
	4. Add_Round_Key (Clave Extendida - Ki)
4. **Ronda Final** (1 vez)
	1. Byte_Sub
	2. Shift_Row
	3. Add_Round_Key (Clave Final - Kr)
5. **Salida**. Texto cifrado
### Operación Byte_Sub
- Se construye una tabla (S-Box) que contiene elementos de un Campo de Gaulois GF
- Inv(X) = Y entonces Inv(Y) = X.
- Cada byte se reemplaza por su inverso en la tabla.
### Operación Add_Round_Key
- Realiza dos operaciones
	- Operación XOR elemento a elemento entre clave y bloque de texto plano.
	- Expansión de clave
		1. Obtiene la última columna y se pasa por el S-Box.
		2. Mueve una posición "hacia arriba".
		3. XOR con la columna `01 00 ... 00`
		4. Resultado se hace XOR con la primera columna.
		5. El resultado es la primera columna y hace XOR con la segunda.
		6. Repetir para todas las columnas

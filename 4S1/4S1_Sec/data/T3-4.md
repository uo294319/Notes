
---
# Autenticación de Mensajes (MAC)

[Back to index](../README.md)

---

## Introducción
- **Def**. Procedimiento para verificar que un mensaje recibido:
	- Proviene realmente del remitente indicado
	- No ha sido modificado
- Aspectos
	- Función en emisor que genera un autenticador
	- Protocolo en receptor que usa el autenticador
- Tipos
	- Cifrado de mensaje
	- Funciones hash
	- Código de autenticación del mensaje
---
## Autenticación mediante cifrado
1. **Cifrado simétrico de mensaje**
	1. Se garantiza el origen ya que solo este y el receptor tienen la clave.
	2. Solo se garantiza la integridad si es un mensaje estructurado
2. **Cifrado simétrico de mensaje y código de control de errores** (checksum)
	1. Puede incluirse el checksum $F(M)$ antes o después de firmar
3. **Cifrado asimétrico del mensaje**
	1. Con clave pública de receptor. (Confidencialidad pero no autenticación)
	2. Con clave privada de emisor. (Autenticación pero no confidencialidad)
	3. Primero privada de emisor y luego pública de receptor (Ambas pero ineficiente)
---
## Message Authentication Code (MAC)
1. **Funcionamiento** (Autenticación e Integridad)
	1. Receptor y emisor comparten una clave $K$
	2. Emisor genera un código con la clave y el mensaje $C(K, M)$
	3. Emisor envía el mensaje concatenado con el código $M \:||\: C(K, M)$
	4. El receptor recibe el mensaje $M'$ y calcula el código $C(K, M')$
	5. El receptor comprueba $C(K, M')$ y $C(K, M)$
2. **Para lograr confidencialidad**
	1. Se combina lo anterior con cifrado simétrico.
	2. Puede usarse en el mensaje solo o en el mensaje y el código.
3. Tipos
	1. Hash-based MAC
	2. Cipher-based MAC
		1. Cifrador de bloque encadenado (CBC)
		2. DAC (Data Authentication Code) son los bits más significativos (al final)
	3. Galois/Counter Mode o GMAC
		1. Mezcla funciones hash y cifradores de bloque simétrico.
---
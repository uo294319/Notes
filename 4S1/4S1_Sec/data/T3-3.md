
---
# Funciones de Resumen (Hash)

[Back to index](../README.md)

---

## Introducción
- **Def**. Función matemática ($H$) que:
	- Genera un resumen de tamaño fijo ($h$)
	- A partir de un mensaje de tamaño variable ($M$).
- **Propiedades básicas**
	- Bajo coste computacional
	- Determinismo
	- Uniformidad
- **Propiedades adicionales** (sistema criptográfico)
	- Unidireccionalidad
	- Difusión
	- Resistencia débil a colisiones (Conociendo M encontrar M')
	- Resistencia fuerte a colisiones (Encontrar M y M')
---
## Autenticación de Mensajes
1. **Idea básica** (vulnerable a MiM)
	1. A calcula el hash del mensaje a enviar $H(M)=h$. Envía $M \:||\: h$ a B.
	2. B recibe el mensaje y calcula su hash. $H(M')=h'$
	3. Si $h = h'$ B puede asumir que $M = M'$.
2. **Mejoras**
	1. Cifrado simétrico en $M \:||\: h$. (Confidencialidad e Integridad)
	2. Cifrado simétrico solo en $h$. (Integridad)
	3. Sin cifrado. Cálculo de hash añadiendo salt $H(M \:||\:S) = h$ (Integridad)
	4. Cifrado simétrico en $M \:||\: h$ y salt. (Confidencialidad e Integridad)
---
## Firma de Mensajes
1. Firma simple (Integridad)
	1. A calcula el hash del mensaje a enviar $H(M)=h$
	2. A encripta el hash con su clave privada y envía $M \:||\: E(h, K_{SA})$ a B
	3. B recibe y desencripta el hash con la clave pública de A para obtener $h$
	4. B calcula el hash del mensaje $h'$ y comprueba que $h = h'$
2. Cifrado simétrico de Mensaje + Firma (Integridad y Confidencialidad)
---
## Funciones Hash
- Message Direct (MD)
	- MD2, MD4 y MD5 generan hashes de 128b. MD6 genera entre 0b y 512b.
	- MD5 se consideró roto en 2010 pero todavía se usa.
- Secure Hash Algorithm (SHA)
	- Desarrollado por encargo de la NSA
	- Familias SHA-0 y SHA-1 se consideran rotas
	- SHA-2 y SHA-3 se usan en la actualidad.
---
## SHA-1
1. Preprocesado 
	1. Rellenado. (Longitud múltiplo de 512b)
		1. El mensaje es de longitud $L$
		2. Se añade 1 bit a `1` y tantos bits a `0` como sea necesario.
		3. Finalmente se añaden $64b$ indicando `L`.
	2. 
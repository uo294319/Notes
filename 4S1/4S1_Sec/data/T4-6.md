
---
# Seguridad Wi-Fi

[Back to index](../README.md)

---
## Introducción
- **Conceptos**
	- `STA`. Estación de transmisión (hosts)
	- `AP`. Punto de acceso (establece conexión inalámbrica entre DS y varios STA)
	- `DS`. Sistema de Distribución
	- `BBS`. Basic Service Set. Conjunto de dispositivos STAs conectados al mismo AP
	- `IBSS` Independent BSS. BSS sin punto de acceso (AP). Forma ad-hoc
	- `ESS`. Extended Service Set. Conjunto de APs conectadas por un DS
- **Capas**
	- **LLC**. No especificada por Wi-Fi
	- **MAC**. MAC Protocol Data Unit = Control + Dest + Origen + MAC Service Data Unit + CRC
	- **Física**
		- Bandas 2.4 GHz (14 canales de 20 o 22 MHz) o 5 GHz (13 canales de 20MH)
		- Permite combinar canales. 2 en 802.11n y 2/4/8 en 802.11ac
		- Multiple-Input and Multiple-Output (MIMO) 4 antenas en 802.11n y 8 en 802.11ac
		- Modulación OFDM (Orthogonal frequency-division multiplexing)
- **Servicios**
	- **Transferencia de datos**
		- **Distribution** (entre BSS en mismo ESS)
		- **Integration** (entre 802.11 y otros 802.XX)
		- **MSDU Delivery** (envío datos)
	- **Asociaciones** (proporcionadas por DS)
		- **Asociación** (STA a AP)
		- **Reasociación** (entre BSS en mismo ESS)
		- **Desasociación** (desconexión STA a AP)
- Seguridad
	- WEP. Incluido en 802.11 y tiene vulnerabilidades
	- Wi-Fi Protected Access (802.11i)
		- WPA (versión preeliminar) / WPA2 (final y en uso) / WPA3 (mejora)
		- Versión Enterprise usa servidor de Autenticación
		- Versión Personal usa
			- Claves precompartidas en WPA y WPA2
			- Simultaneous Authentication of Equals (SAE) en WPA3
	- 
## Funcionamiento
![](../assets/Pasted%20image%2020251204112109.png)
### Fase 1. Discovery
- Objetivo. Autenticación, acuerdo de capacidades de seguridad y asociación.
- Pasos
	1. Probe Request/Response
		1. STA descubre AP pasiva (AP emite beacon) o activamente (probando cada canal).
		2. AP responde con las capacidades de seguridad que soporta.
	2. Open System Auth Request/Response (ejemplo null Authentication)
		1. Intercambio de identificadores
	3. Association Request/Response.
		1. STA escoge método de auth y suite de gestión de claves de los recibidos en paso 1
### Fase 2. Authentication

|      | Personal                       | Enterprise                     |
| ---- | ------------------------------ | ------------------------------ |
| WPA  | Auth: PSK<br>Cifrado: TKIP/MIC | Auth: EAP<br>Cifrado: TKIP/MIC |
| WPA2 | Auth: PSK<br>Cifrado: AES-CCMP | Auth: EAP<br>Cifrado: AES-CCMP |
| WPA3 | Auth: SAE<br>Cifrado: AES-CCMP | Auth: EAP<br>Cifrado: AES-CCMP |
- PKS = Pre_Shared Key / SAE = Simultaneous Auth of Equals
- **Protocolo EAP (Extensible Auth Protocol)**
	- Def. Servicio de transporte genérico para auth entre cliente-servidor
	- Extensible. Soporta varios métodos de autenticación
		- EAP-TLS. Encapsula EAP en Transport Layer Security (TLS)
		- EAP-Tunneled TLS. Igual que EAP-TLS pero solo servidor con certificado
		- EAP-Generalized PKS.
			- Auth mutua. Deriva clave de sesión a partir de claves pre-compartidas.
		- EAP-IKEv2 (Internet Key Exchange). Auth mutua y establece claves sesión con IKE
	- Formato mensajes. Código + Identificador + Longitud + Datos
	- Intercambio mensajes
	![](../assets/Pasted%20image%2020251204115430.png)
- 802.1X
	- Funciones de control de acceso para LANs basadas en puertos
	- Un puerto es un canal lógico de comunicación mapeado a una conexión física.
	- Cada entidad usa dos canales
		- Canal control en puerto no controlado
			- Permite intercambio PDUs independiente del estado auth suplicante
		- Canal de datos en puerto controlado
			- Solo permite intercambio PDS para suplicantes auth
	- EAPOL (EAP Over LAN)
		- Empieza con EAPOL-Start
		- Mismos intercambios de mensaje que EAP 
		- Finaliza con EAPOL-Logoff
### Fase 3. Key Management
### Fase 4. Protected Data Transfer
### Phase 5. Connection Termination

---
## 

### Protocolo IEEE 802.1X


---
# Cifrado Asimétrico

[Back to index](../README.md)

---

## RSA
### Generación de Claves
1. Elegimos dos primos $p$ y $q$
2. Módulo $n=p\times q$
3. Función de Euler $\varphi(n) = (p-1)\times (q-1)$
4. Elegir y verificar exponente de clave pública ($e$)
	1. Verificar que es un primo con: $1\leq e < \varphi(n)$
	2. Coprimo de $\varphi(n)$. $e$ no se encuentra entre los factores de $\varphi(n)$
5. Calcular exponente de clave privada ($d$)
	1. Debe cumplir $(d\times e) \mod \varphi(n) = 1$
	2. Buscamos $1=a\times \varphi(n) + b \times e$ donde $b$ será nuestro $d$
	3. Uso del algoritmo de Euclides (descomposición)
### Cifrado y descifrado
- Cifrado con llave pública: $C = M^e \mod n$
- Descifrado con llave privada: $M = C^d \mod n$
- Podemos usar la propiedad $(a\times b) \mod n = [(a \mod n) \times (b \mod n)]$
### Ataques contra RSA
- Se conoce la clave pública $e$ y el módulo $n$
- Encontrar por fuerza bruta un $d$ tal que descifre el mensaje es inviable.
- Ataque estándar
	- Intentar obtener los primos $p$ y $q$ que forman $n$ (inviable con números grandes)
	- Calcular $\varphi(n)$ y resolver ecuación $(d\times e) \mod \varphi(n) = 1$
### Técnicas de Relleno
- Evitan un análisis de frecuencia o patrones
- Relleno PKCS#1
	- EM = `0x00` + `0x02`+ PS+ `0x00` + M
	- Donde el relleno PS son bytes aleatorios
	- `len(PS) = len(módulo RSA) - len(M) - 3`
- Relleno OAEP
### Problema de RSA y Uso
- Problema
	- Cifrado tiene coste computacional elevado
	- Cifrar gran volumen de información lleva mucho tiempo
- Solución. Cripto-esquemas híbridos
	- Se usa asimétrica (Diffie-Hellman) para intercambio cifrado de lista de números aleatorios
	- Luego, envío de información con simétrica (AES) usando números de la lista como clave.
---
## Diffie-Hellman
### Fases
1. A y B comparten un módulo $p$ (primo) y un generador $g$ 
2. A y B escogen sus calves privadas $K_{SA}$ y $K_{SB}$ 
3. A y B calculan sus claves públicas $K_{P} = g^{K_S}\mod p$ y luego la comparten
4. A y B calculan la clave secreta compartida $K_{SC} = (K_{PB})^{K_{PA}} \mod p = (K_{PA})^{K_{PB}} \mod p$
